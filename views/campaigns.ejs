<script>
  document.addEventListener("DOMContentLoaded", function () {
    console.log('[AppBridge] DOM loaded');

    const AppBridge = window['app-bridge'];
    const createApp = AppBridge.default;
    const actions = AppBridge.actions;
    const hostParam = new URLSearchParams(window.location.search).get("host");

    console.log('[AppBridge] Host param:', hostParam);

    const app = createApp({
      apiKey: "<%= process.env.SHOPIFY_API_KEY %>",
      shopOrigin: "<%= shop %>",
      host: hostParam,
      forceRedirect: true
    });

    const TitleBar = actions.TitleBar;
    TitleBar.create(app, { title: 'Upsell Campaigns' });

    console.log('[AppBridge] Initialized successfully');
  });
</script>
